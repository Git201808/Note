# 应用层_应用服务及相关协议

## 应用层些协议的特点

- 每个应用层协议都是为了解决某一类应用问题，而问题的解决有往往是通过位于不同主机中的多个应用进程之间的通信和协同工作来完成的。应用层的具体内容就是规定应用进程的通信时所遵循的协议
- 应用层的许多协议都是基于客户服务器方式。客户(client)和服务器(server)都是指通信中所涉及的两个应用进程。客户服务器方式所描述的是进程之间的服务和被服务的关系。客户是服务请求方，服务器是服务提供方。

## 6.1 域名系统DNS

### 6.1.1 域名系统概述

- 许多应用层软件经常直接使用**域名系统**DNS(Domain Name System)，但计算机的用户只是间接而不是直接使用域名系统。
- 互联网采用层次结构的命名数作为主机的名字，并使用**分布式**的域名系统DNS。
- 名字到IP地址的解析是有若干个域名服务器程序完成的。域名服务器程序在专设的结点上运行，运行该程序的机器称为**域名服务器**。

### 6.1.2 互联网的域名结构

- 互联网采用了层次树状结构的命名方法。

- 任何一个连接在互联网上的主机或路由器，都有一个**唯一**的层次结构的名字，即**域名**。

- 域名的结构有标号序列组成，各标点之间用点隔开：

  **… .三级域名 . 二级域名 . 顶级域名**

- 各标号分别代表不同级别的域名。

#### 域名只是个逻辑概念

- 域名只是个**逻辑概念**，并不代表计算机所在的物理地点。
- 变长的域名和使用有助记忆的字符串，是为了便于人来使用。 而IP地址是定长的32位二进制数字则非常便于机器进行处理。
- 域名中的“点”和点分十进制IP地址中的“点”并无一一对应的关系。点分十进制IP地址中一定是包含三个“点”，但每一个域名中“点”的数目则不一定正好是三个。

#### 顶级域名TLD(Top Level Domain) 

(1)国家顶级域名nTD

.cn 表示中国，.us 表示美国，.uk表示英国，等等。

(2)通用顶级域名gTLD

最最的顶级域名是：.com(公司和企业)	.net(网络服务机构)	.org(非盈利性组织)	.edu(美国专用的教育机构)	.gov(美国专用的政府部门)	.mil(美国专用的军事部门)	.int (国际组织)

### 6.1.3 域名服务器

- 一个服务器所负责管辖的(或有权限的)范围叫做**区**(zone)。
- 各单位根据具体情况来划分自己管辖范围的区。但在一 个区中的所有节点必须是能够连通的。
- 每一个区设置相应的**权限域名服务器**，用来保存该区的所有主机的域名到IP地址的映射。
- DNS服务器的管辖范围不是以“域”为单位，而是以“区”为单位。

-----

#### 域名服务器有以下四种类型

- **根域名服务器**

  - 根域名服务器是**最高层次**的域名服务器，也是**最重要**的域名服务器。所有的根域名服务器都知道所有的顶级域名服务器的域名和IP地址。
  - 不管是哪一个本地域名服务器，若要对互联网上任何一个域名进行解析，只要自己无法解析，就首先求助于根域名服务器。
  - 在互联网上共有13个不同IP地址的根域名服务器，它们的名字是用一个英文字母命名，从a一直到m(前13个字母)

  **根域名服务器共有13套装置**

  - 根域名服务器共有13套装置，不是13个机器。
  - 这些根域名服务器相应的域名分别是：
    - a.rootservers.net
    - b.rootservers.net
    - …
    - m.rootservers.net
  - 到2016年2月，全世界已经在588个地点安装了根域名服务器，使世界上大部分DNS域名服务器都能**接近**找到了一个根域名服务器。

- **顶级域名服务器**

  - 顶级域名服务器(即TLD服务器)负责管理在该顶级域名服务器注册的所有二级域名。
  - 当收到DNS查询请求时，就给出相应的回答(可能是最后的结果，也可能是下一步应当找的域名服务器的IP地址)。

- **权限域名服务器**

  - 负责一个区的域名服务器
  - 当一个权限域名服务器还不能给出最后的查询回答时，就会告告诉发出查询请求的DNS客户，下一步应当找哪一个权限域名服务器。

- **本地域名服务器**

  - 本地域名服务器对域名系统非常重要。
  - 当一个主机发出DNS查询请求时，这个查询请求报文就发送给本地域名服务器。
  - 每一个互联网服务提供者ISP，或一大学，甚至一个大学里的系，都可以拥有一个本地域名服务器
  - 这种域名服务器有时也称为**默认域名服务器**。

-----

#### 提高域名服务器的可靠性

- DNS域名服务器都把数据复制到几个域名服务器来 报存，其中的一个是**主域名服务器**，其他的是**辅助域名服务器**。
- 当主域名服务器出故障是，辅助域名服务器可以保证DNS的查询工作不会中断。
- 主域名服务器定期把数据复制到辅助域名服务器中，而更改数据只能在主域名服务器中进行。这样就保证了数据的一致性。

#### 域名的解析过程

- **主机向本地域名服务器的查询一般都是采用<u>递归查询</u>**。如果主机所询问的本地域名服务器不知道被查询域名的IP地址，那么本地域名服务器就以DNS客户的身份，向其他根域名服务器继续发出查询请求报文。
- **本地域名服务器向根域名服务器的查询通常是采用<u>迭代查询</u>**。当根域名服务器收到本地域名服务器的迭代查询请求报文时，要么给出所查询个IP地址，要么告诉本地域名服务器：“你下一步应当向哪一个域名服务器进行查询”。然后让本地域名服务器进行后续的查询。

#### 名字的高速缓存

- **每一个域名服务器都维护一个高速缓存，**存放最近用过的名字以及从何处获得名字映射信息的记录。
- 可大大减轻根域名服务器的负荷，使互联网上DNS查询请求和回答报文的数量大为减少。
- 为保持高速缓存中的内容正确，域名服务器应为每项内容设置计时器，并处理超过合离时间的项（例如，每个项目只存放两天）。
- 当权限域名服务器回答一个查询请求时，在响应中都指明绑定有效存在的时间值。增加此时间值可减少网络开销，而减少此时间值可提高域名转换的准确性。

-----

## 6.2 文件传送协议

### 6.2.1 FTP概述

- **文件传送协议**FTP(File Transfer Protocol)是互联网上使用得最广泛的文件传送协议。
- FTP提供**交互式**的访问，允许客户指明文件的类型与格式，并允许文件具有存取权限。
- FTP屏蔽了各计算机系统的细节，因而适合于在异构网络中任意计算机之间传送文件。
- RFC 959  很早就成为了互联网的正式标准。

#### 文件传送并非很简单的问题

- 网络环境中的一项基本应用就是将文件从一台计算机中复制到另一台可能相距很远的计算机中。
- 初看起来，在两个主机之间传送文件是很简单的事情。
- 其实这往往非常困难。原因是众多的计算机厂商研制出文件系统多大数百种，且差别很大。

### 6.2.2 FTP的基本工作原理

网络环境下复制文件的复杂性：

- (1)计算机存储数据的格式不同。
- (2)文件的目录结构和文件命名的规定不同。
- (3)对于相同的文件存取功能，操作系统使用的命令不同。
- (4)访文控制方法不同。

### FTP特点

- 文件传送协议FTP只提供文件传送的一些基本的服务，它使用TCP可靠的运输服务。
- FTP的主要功能是减少或消除在不同操作系统下处理文件的不兼容性。
- FTP使用**客户服务器方式**。一个FTP服务器远程可同时为多个客户进程提供服务。FTP的服务器进程由两大部分组成：**一个主进程**，负责接受新的请求;另外有**若干个从属进程**，负责处理单个请求。

#### 主进程的工作步骤

- 打开熟知端口(端号为21)，使客户进程能够连接上。
- 等待客户进程发出连接请求。
- 启动从属进程来处理客户进程发来的请求。从属进程的请求处理完毕后即终止，但从属进程在运行期间根据需要还可能创建其他一些子进程。

### 两个不同的端口号

- 当客户进程向服务器进程发出建立连接请求时，要寻找连接服务器进程的**熟知端口(**21)，同时还要告诉服务器进程自己的另一个端口号码，用于建立数据传送连接。
- 接着，服务器进程用自己传送数据的**熟知端口**(20)与客户进程提供的端口号码建立数据传送连接。
- 由于FTP使用了两个不同的端口号，所以数据连接与控制连接不会发生混乱。

### 6.2.3 简单文件传送协议TFTP

##  6.3 远程终端协议TELNET

## 6.4 万维网 WWW

## 6.5 电子邮件

## 6.6 动态主机配置协议DHCP

## 6.7 应用进程跨网络的通信



