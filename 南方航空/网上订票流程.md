# 南方航空网上订票流程

## 航班查询
在该页面选择（出发城市，到达城市，查询日期）行程是单程&往返&多程
在view拿到查询相关的数据后，通过sesionStrong来储存用户选择的查询数据，点击下一步（获取到用户输入的查询数据，在获取数据后对数据进行判断，是否为空，为空就提示数据不完整，请重新输入，或补充数据）跳转到航班选择


那么如何查询到返回程信息呢？
行程类型，（单程&多程）行程类型下的选中判断，如何判断？

一个查询按扭对应多个查询框

## 航班选择（查
在该页面，在页面加载的同时，设置一个函数，获取到sessionStrong中储存的数据，并且回填到，航班查询的条件框中去，并且在页面加载完成的同时。请求查询方法，页面重载加载查询后的航班数据。

获取到用户选择的航班数据，将相关的航班数据放到sessionStrong中，或者获取后（将数据提交到指定路径中去，放到相关的页面）在指定的页提取相关数据进行查询，以传递后的数据，重新在数据库中查询出相应的航班信息

如果在存在sessionStrong中，可以在下一个旅客信息页面直接提取出来，提取出来后，在页面回填相关数据即可，不需要再次查询，也可以再次从sessionStrong中再次查询。

## 旅客信息 （增

在旅客信息这view页面，除了回填相关的航班信息，还要新增，订单，乘机人，联系人等数据。

1. 先新增订单信息表，默认下订单为**未支付**状态，在新增订单完成后。
2. 新增乘客信息的同时给该乘客添加一个订单id，以此来对应一张订单下有多个乘客，
3. 新增联系人的同时也给他添加一个订单id以此来关联订单信息。这样一来就可以在查询订单的同时，查询到该订单下的乘客信息，联系人信息，


## 支付订单 （改
点击下一步，支付订单（变相的就是修改订单的状态信息，也就是修改订单）
修该相关选项，订单状态，支付id（支付方式），支付的时间(时间直接获取，或者从页面上拿到相关的数据)

！！！ 但在这里出现一个问题，就是我需要把乘客信息数据回填，问题是：新增的乘客信息是通过订单id来获取的，那么怎么，把数据给查出来呢？，以single来查只能得到一条数据或者拿不到数据。

修改：判断数据是否存在重复的数据

提取需要修改的数据，从提取的数据中把所需要修改数据拿出来进行修改。修改的数据等于页面传递的数据

## 完成支付



## 一切的一切，都是 “增、删、查、改”

查：查询中使用.count();

这里的count表示总条数   前面使用int，对象的格式为整数  判断里面有几个
``` 
int countStudent = (from tbStudent in myModels.B_Indent
                                    where tbStudent.IndentID != pwIndet.IndentID &&
                                    (tbStudent.IndentNumber == pwIndet.IndentNumber ||
                                    tbStudent.IndentState == pwIndet.IndentState)
                                    select tbStudent).Count();
```

而如果要把他给点出来需要使用.single() 数据唯一  使用try--- catch--